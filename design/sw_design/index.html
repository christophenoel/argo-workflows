
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../helm_charts/">
      
      
        <link rel="next" href="../rest_api_design/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Software Design - Argo Workflows documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../css/mkdocsoad.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#software-design-document-for-argo-workflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Argo Workflows documentation" class="md-header__button md-logo" aria-label="Argo Workflows documentation" data-md-component="logo">
      
  <img src="../../assets/logo-dimsum-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Argo Workflows documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Software Design
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/dimsum-project/argo-workflows" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    argo-workflows
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user_manual/" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../installation_manual/" class="md-tabs__link">
          
  
  Operator Guide

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Software Design

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../rest_api_design/" class="md-tabs__link">
          
  
  Interfaces

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../LICENSE/" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Argo Workflows documentation" class="md-nav__button md-logo" aria-label="Argo Workflows documentation" data-md-component="logo">
      
  <img src="../../assets/logo-dimsum-white.svg" alt="logo">

    </a>
    Argo Workflows documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dimsum-project/argo-workflows" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    argo-workflows
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software User Manual
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow_design_manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow Design Manual
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial_cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial_rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial_gui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GUI Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operator Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Operator Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation_manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helm_charts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helm Charts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Software Design
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Software Design
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general" class="md-nav__link">
    <span class="md-ellipsis">
      General
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-identifier" class="md-nav__link">
    <span class="md-ellipsis">
      Component Identifier
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type" class="md-nav__link">
    <span class="md-ellipsis">
      Type
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logical-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Logical Characteristics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Physical Characteristics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#purpose" class="md-nav__link">
    <span class="md-ellipsis">
      Purpose
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    <span class="md-ellipsis">
      Function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reusable-workflow-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Reusable Workflow Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dag-workflow-creation" class="md-nav__link">
    <span class="md-ellipsis">
      DAG Workflow Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-artefacts" class="md-nav__link">
    <span class="md-ellipsis">
      Data Artefacts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retry-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Retry Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notification" class="md-nav__link">
    <span class="md-ellipsis">
      Notification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Constraints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hardware Constraints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#capabilities-and-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Capabilities and Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-hardware-constraints-work" class="md-nav__link">
    <span class="md-ellipsis">
      How Hardware Constraints Work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Example Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artefact-persistence-and-retention" class="md-nav__link">
    <span class="md-ellipsis">
      Artefact Persistence and Retention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subordinates" class="md-nav__link">
    <span class="md-ellipsis">
      Subordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Interfaces
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interfaces
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rest_api_design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST API Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rest_api_spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST API Specification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general" class="md-nav__link">
    <span class="md-ellipsis">
      General
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-identifier" class="md-nav__link">
    <span class="md-ellipsis">
      Component Identifier
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type" class="md-nav__link">
    <span class="md-ellipsis">
      Type
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logical-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Logical Characteristics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Physical Characteristics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#purpose" class="md-nav__link">
    <span class="md-ellipsis">
      Purpose
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    <span class="md-ellipsis">
      Function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reusable-workflow-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Reusable Workflow Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dag-workflow-creation" class="md-nav__link">
    <span class="md-ellipsis">
      DAG Workflow Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-artefacts" class="md-nav__link">
    <span class="md-ellipsis">
      Data Artefacts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retry-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Retry Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notification" class="md-nav__link">
    <span class="md-ellipsis">
      Notification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Constraints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hardware Constraints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#capabilities-and-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Capabilities and Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-hardware-constraints-work" class="md-nav__link">
    <span class="md-ellipsis">
      How Hardware Constraints Work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Example Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artefact-persistence-and-retention" class="md-nav__link">
    <span class="md-ellipsis">
      Artefact Persistence and Retention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subordinates" class="md-nav__link">
    <span class="md-ellipsis">
      Subordinates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Interfaces
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="software-design-document-for-argo-workflow">Software Design Document for Argo-Workflow</h1>
<h3 id="general">General</h3>
<p>This section provides a detailed look at the design aspects of each component used in the software. </p>
<h3 id="component-identifier">Component Identifier</h3>
<ul>
<li><strong>Component Identifier</strong>: Argo-Workflows</li>
<li><strong>System Logical Component</strong> Workflow Engine: </li>
</ul>
<p>Argo Workflows enables the chaining of container-based modules and workflows.</p>
<h3 id="type">Type</h3>
<h4 id="logical-characteristics">Logical Characteristics</h4>
<p>Argo Workflows is the main functional component implementing the Data Processing Environment sub-system of the OHDSA platform.</p>
<h4 id="physical-characteristics">Physical Characteristics</h4>
<p>Argo Workflows is a Commercial-Of-The-Shelf (COTS) Kubernetes-native workflow engine that orchestrates parallel jobs on a Kubernetes cluster. It uses Kubernetes resources like custom resources, pods, jobs, ConfigMaps, and Secrets to implement and manage workflows. Each workflow is defined as a Workflow object, which dictates the sequence of tasks to be executed. These tasks are encapsulated as Kubernetes Jobs or Pods, making each step of the workflow a discrete, schedulable unit under Kubernetes management.</p>
<h3 id="purpose">Purpose</h3>
<p>Argo Workflows component is designed to fulfill a pivotal role in managing and executing complex workflows that integrate various modules within Docker containers. The purpose of Argo Workflows is to enable users to submit both simple and elaborate workflows with a versatile Workflow Definition Language that accommodates Directed Acyclic Graph models, dynamic resource allocation, retry strategies, the utilisation of specialized hardware, and completion notifications. </p>
<h3 id="function">Function</h3>
<p>Argo Workflows is a container-native workflow engine for Kubernetes, designed to orchestrate parallel jobs in a cloud environment.</p>
<p>The following subsections focus on the implementation of the <strong>OHDSA capabilities</strong> supported by the workflow engine.</p>
<h4 id="api">API</h4>
<p>The Argo Workflows component provides a REST API that facilitates the creation, management, and monitoring of workflows.</p>
<p>Key API Operations:</p>
<ol>
<li><strong>Create Workflow Template</strong>: Allows the user to define and register a reusable workflow template.</li>
<li><strong>List Available Workflow Templates</strong>: Retrieves a list of all registered workflow templates.</li>
<li><strong>Describe Workflow Template</strong>: Provides detailed information about a specific workflow template.</li>
<li><strong>List Workflows</strong>: Returns a list of all active and completed workflows.</li>
<li><strong>Submit Workflow</strong>: Initiates a new workflow based on a specified workflow template.</li>
<li><strong>Delete Workflow</strong>: Removes a specified workflow from the system.</li>
<li><strong>Retrieve Workflow Status</strong>: Fetches the current status of a specific workflow.</li>
<li><strong>Retrieve Workflow Logs</strong>: Provides access to the logs generated by a specific workflow.</li>
</ol>
<p>For detailed documentation and examples of these API operations, refer to the <a href="../rest_api_design/">API Design Documentation</a>.</p>
<h4 id="reusable-workflow-templates">Reusable Workflow Templates</h4>
<p>Argo Workflows supports the creation and utilisation of reusable workflow templates to standardise and streamline workflow definitions.</p>
<p>Reusable workflow templates in Argo Workflows allow users to define a set of tasks and their configurations once and reuse them across multiple workflows. </p>
<p>The templates encapsulate the following elements:</p>
<ul>
<li><strong>Entrypoint</strong>: Defines the main entry point for the workflow, specifying the starting task.</li>
<li><strong>Templates</strong>: Lists the tasks included in the workflow template, each with its own configuration such as container image, commands, and arguments.</li>
</ul>
<p>The following <a href="../../examples/hello-world-template/hello-world-wf-template.yml">example</a>
represents a basic workflow template definition:
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WorkflowTemplate</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-world-wft</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">whalesay</span>
<span class="w">  </span><span class="nt">templates</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">whalesay</span>
<span class="w">      </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span>
<span class="w">      </span><span class="nt">container</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/whalesay</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">cowsay</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;{{inputs.parameters.message}}&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div></p>
<p>The usage of workflow template works as follows:</p>
<ol>
<li>
<p><strong>Definition</strong>: Users define a workflow template, specifying the tasks and their configurations. This is done using YAML, where each task within the template is defined with its specific parameters and resources.</p>
</li>
<li>
<p><strong>Registration</strong>: The defined workflow template is registered with the Argo system using the appropriate API endpoint. This makes the template available for use in workflows.</p>
</li>
<li>
<p><strong>Reuse</strong>: Once registered, the workflow template can be referenced in multiple workflows. This is achieved by specifying the template reference in the workflow definition, allowing the workflow to utilise the predefined tasks and configurations.</p>
</li>
<li>
<p><strong>Execution</strong>: When a workflow that references a reusable template is executed, Argo orchestrates the tasks as defined in the template, ensuring that each task is executed according to the specified configuration.</p>
</li>
</ol>
<p>Argo provides a REST API to manage workflow templates, including operations to create, list, describe, and delete templates. This API facilitates the integration of workflow template management into automated processes and external systems.</p>
<h4 id="dag-workflow-creation">DAG Workflow Creation</h4>
<p>Argo Workflows supports the creation of Directed Acyclic Graph (DAG) workflows, which allow for the definition of complex workflows with dependencies between tasks. This capability ensures optimal execution order and efficient resource utilisation.</p>
<p>DAG workflows in Argo enable users to define workflows where tasks are executed based on their dependencies. This means that a task will only start once all its dependent tasks have been completed successfully.</p>
<ul>
<li><strong>Task Dependencies</strong>: Tasks in a DAG can specify dependencies, indicating which tasks need to be completed before they can be executed.</li>
<li><strong>Parallel Execution</strong>: Independent tasks can run in parallel, maximising resource usage and reducing overall execution time.</li>
<li><strong>Template Reuse</strong>: DAG workflows can reference reusable workflow templates, allowing for modular and maintainable workflow definitions.</li>
<li><strong>Dynamic Execution</strong>: The DAG model supports dynamic execution paths, where the workflow can adapt based on the results of preceding tasks.</li>
</ul>
<p>The process of creating and executing a DAG workflow is as follows:</p>
<ol>
<li><strong>Definition</strong>: A DAG workflow is defined in a YAML file, where the <code>templates</code> section includes a <code>dag</code> template that specifies the tasks and their dependencies.</li>
<li><strong>Task Specification</strong>: Each task within the DAG is defined with a <code>name</code>, <code>templateRef</code> to reference reusable templates, and <code>dependencies</code> to specify other tasks that must complete before this task starts.</li>
<li><strong>Execution</strong>: When the DAG workflow is submitted, Argo orchestrates the execution based on the defined dependencies. Tasks are scheduled to run in the optimal order, ensuring that each task only starts once all its dependencies are resolved.</li>
</ol>
<p>Below is a minimal example of a DAG workflow definition:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dag-example-</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dag-example</span>
<span class="w">  </span><span class="nt">templates</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dag-example</span>
<span class="w">      </span><span class="nt">dag</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">task-1</span>
<span class="w">            </span><span class="nt">templateRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some-template</span>
<span class="w">              </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some-task</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">task-2</span>
<span class="w">            </span><span class="nt">dependencies</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">task-1</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">templateRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some-template</span>
<span class="w">              </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">another-task</span>
</code></pre></div>
<p>In this example:
* apiVersion: Specifies the API version.
* kind: Indicates the resource type, which is Workflow.
* metadata: Contains metadata, including the workflow name.
* spec: Defines the specifications of the workflow.
* entrypoint: Specifies the main entry point for the DAG workflow.
* templates: Lists the tasks included in the DAG workflow.
* dag: Defines the DAG structure with tasks and their dependencies.</p>
<h4 id="data-artefacts">Data Artefacts</h4>
<p>Argo Workflows supports the management of data artefacts, enabling the staging-in, staging-out, and passing of data between workflow steps. This capability is essential for handling input and output data efficiently within workflows.</p>
<p>The features of Argo Workflows for managing data artefacts include:</p>
<ul>
<li><strong>Artifact Repositories</strong>: Argo supports the use of artifact repositories for storing and retrieving data. These repositories can be any S3-compatible storage, such as Minio, or other interfaces like GIT.</li>
<li><strong>Input Artefacts</strong>: Workflows can specify input artefacts that are provided as arguments when the workflow is executed.</li>
<li><strong>Intermediate Artefacts</strong>: Intermediate data generated during workflow execution can be stored in artifact repositories to be used by subsequent steps.</li>
<li><strong>Output Artefacts</strong>: Workflows can create and store output artefacts in designated repositories, which can then be accessed by other workflows or external systems.</li>
<li><strong>Credential Agnosticism</strong>: Workflow templates do not manage credentials directly. Instead, artefact management is handled by the workflow runtime, ensuring security and separation of concerns.</li>
</ul>
<p>The process for managing data artefacts in Argo Workflows is as follows:</p>
<ol>
<li><strong>Configuration</strong>: Define artifact repositories within Kubernetes ConfigMaps. These repositories are referenced in workflow templates to standardise artefact handling across workflows.</li>
<li><strong>Data Input</strong>: Specify input artefacts in the workflow template. These artefacts are passed as arguments when the workflow is invoked.</li>
<li><strong>Intermediate Storage</strong>: Store intermediate artefacts in the default or specified artifact repository, ensuring they are accessible for subsequent workflow steps.</li>
<li><strong>Data Output</strong>: Create and store output artefacts in artifact repositories, enabling reuse and integration with other workflows or systems.</li>
</ol>
<p>Below is a minimal example of an artifact repository configuration in a Kubernetes ConfigMap:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">artifact-repositories</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default-artifact-repository</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">s3:</span>
<span class="w">      </span><span class="no">bucket: argo-bucket</span>
<span class="w">      </span><span class="no">endpoint: minio:9000</span>
<span class="w">      </span><span class="no">insecure: true</span>
<span class="w">      </span><span class="no">accessKeySecret:</span>
<span class="w">        </span><span class="no">name: my-minio-cred</span>
<span class="w">        </span><span class="no">key: accesskey</span>
<span class="w">      </span><span class="no">secretKeySecret:</span>
<span class="w">        </span><span class="no">name: my-minio-cred</span>
<span class="w">        </span><span class="no">key: secretkey</span>
</code></pre></div>
<p>In this example:</p>
<ul>
<li>apiVersion: Specifies the API version.</li>
<li>kind: Indicates the resource type, which is ConfigMap.</li>
<li>metadata: Contains metadata, including the ConfigMap name.</li>
<li>data: Defines the artifact repository configuration, including S3 endpoint details and credentials.</li>
</ul>
<h4 id="retry-strategy">Retry Strategy</h4>
<p>Argo Workflows provides robust retry strategies to handle task failures effectively, ensuring that workflows can recover from transient errors and improve reliability.</p>
<p>The retry strategy in Argo Workflows allows for the configuration of retries for failed tasks, providing flexibility in handling different types of errors. Key features include:</p>
<ul>
<li><strong>Limit Parameter</strong>: Specifies the maximum number of retry attempts for a task.</li>
<li><strong>Retry Policies</strong>: Defines conditions under which a task should be retried. Available policies include:</li>
<li><strong>Always</strong>: Retries all failed tasks regardless of the failure type.</li>
<li><strong>OnFailure</strong>: Retries tasks that are marked as failed by Kubernetes.</li>
<li><strong>OnError</strong>: Retries tasks that encounter errors related to the Argo controller or when init or wait containers fail.</li>
<li><strong>OnTransientError</strong>: Retries tasks that encounter transient errors or errors matching a specific pattern.</li>
<li><strong>Expressions</strong>: Utilises expressions to control retry behaviour, accessing variables such as <code>lastRetry.exitCode</code>, <code>lastRetry.status</code>, <code>lastRetry.duration</code>, and <code>lastRetry.message</code>.</li>
<li><strong>Backoff</strong>: Implements a delay between retry attempts to prevent immediate consecutive retries, which can help mitigate issues from transient failures.</li>
</ul>
<p>The process for implementing retry strategies in Argo Workflows is as follows:</p>
<ol>
<li><strong>Define Retry Parameters</strong>: Specify the limit for retries and the retry policy within the workflow or template definition.</li>
<li><strong>Set Retry Conditions</strong>: Use expressions to determine when a retry should be attempted based on the status and exit codes of previous attempts.</li>
<li><strong>Configure Backoff</strong>: Define the backoff strategy to introduce delays between retry attempts, helping to manage the load and reduce the likelihood of repeated failures.</li>
</ol>
<p>Below is a minimal example of a retry strategy configuration in a workflow:</p>
<p><div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">retry-strategy-</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">retry-example</span>
<span class="w">  </span><span class="nt">templates</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">retry-example</span>
<span class="w">      </span><span class="nt">retryStrategy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">        </span><span class="nt">retryPolicy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;OnFailure&quot;</span>
<span class="w">        </span><span class="nt">backoff</span><span class="p">:</span>
<span class="w">          </span><span class="nt">duration</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5s&quot;</span>
<span class="w">          </span><span class="nt">factor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">container</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sh&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;exit</span><span class="nv"> </span><span class="s">1&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div>
In this example:</p>
<ul>
<li>retryStrategy.limit: Specifies the maximum number of retry attempts.</li>
<li>retryStrategy.retryPolicy: Sets the retry policy to retry on failure.</li>
<li>retryStrategy.backoff: Configures a backoff strategy with an initial delay of 5 seconds and an exponential backoff factor of 2.</li>
</ul>
<h4 id="notification">Notification</h4>
<p>Argo Workflows provides mechanisms to send notifications based on workflow events, ensuring users are informed about the status and results of their workflows.</p>
<p>The notification features in Argo Workflows enable users to configure alerts and messages for various workflow events, such as completions, failures, and other significant statuses. Key features include:</p>
<ul>
<li><strong>Exit Handlers</strong>: Define actions to be taken upon workflow completion, allowing notifications to be sent based on the workflow's outcome.</li>
<li><strong>Notification Types</strong>: Support for various notification types, such as emails, messages via protocols like AMQP, or custom scripts.</li>
<li><strong>Custom Containers</strong>: Use custom containers to execute commands that send notifications, offering flexibility in how notifications are handled and delivered.</li>
</ul>
<p>The notification system in Argo Workflows operates as follows:</p>
<ol>
<li><strong>Define Exit Handlers</strong>: Configure exit handlers in the workflow definition. These handlers specify the actions to be executed when the workflow completes, regardless of success or failure.</li>
<li><strong>Custom Containers for Notifications</strong>: Implement custom containers within exit handlers to perform notification actions. These containers can run scripts or commands to send emails, messages, or other notifications.</li>
</ol>
<p>Below is a minimal example of a workflow configuration with an exit handler that sends a message to a RabbitMQ queue upon workflow completion:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">notify-rabbitmq-example-</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">  </span><span class="nt">templates</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">      </span><span class="nt">container</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sh&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;exit</span><span class="nv"> </span><span class="s">0&quot;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">onExit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">notify</span>
<span class="w">  </span><span class="nt">templates</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">notify</span>
<span class="w">      </span><span class="nt">container</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rabbitmq:3-management</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sh&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">args</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">            </span><span class="no">apt-get update &amp;&amp; apt-get install -y curl</span>
<span class="w">            </span><span class="no">curl -i -u guest:guest -H &quot;content-type:application/json&quot; \</span>
<span class="w">            </span><span class="no">-X POST -d &#39;{&quot;properties&quot;:{},&quot;routing_key&quot;:&quot;&quot;,&quot;payload&quot;:&quot;Workflow completed successfully&quot;,&quot;payload_encoding&quot;:&quot;string&quot;}&#39; \</span>
<span class="w">            </span><span class="no">http://rabbitmq:15672/api/exchanges/%2F/amq.default/publish</span>
</code></pre></div>
<h4 id="hardware-constraints">Hardware Constraints</h4>
<p>Argo Workflows allows for the specification of hardware constraints to ensure that workflows run on nodes with the appropriate resources and capabilities. This feature is essential for optimising resource usage and ensuring that workflows can utilise specialised hardware as needed.</p>
<h5 id="capabilities-and-usage">Capabilities and Usage</h5>
<p>The features for managing hardware constraints in Argo Workflows include:</p>
<ul>
<li><strong>Resource Requests and Limits</strong>: Define the amount of CPU and memory resources required for each task.</li>
<li><strong>Node Affinity</strong>: Specify node affinity rules to ensure that tasks are scheduled on nodes with specific labels, indicating specialised hardware or other node-specific attributes.</li>
<li><strong>Tolerations</strong>: Define tolerations to allow tasks to be scheduled on tainted nodes, which can be used to reserve nodes for specific types of workloads.</li>
</ul>
<h5 id="how-hardware-constraints-work">How Hardware Constraints Work</h5>
<p>The process for implementing hardware constraints in Argo Workflows is as follows:</p>
<ol>
<li><strong>Define Resource Requirements</strong>: In the workflow template, specify the CPU and memory resources required for each task using <code>resources.requests</code> and <code>resources.limits</code>.</li>
<li><strong>Set Node Affinity</strong>: Use <code>nodeSelector</code> or <code>affinity</code> fields in the workflow template to ensure tasks are scheduled on nodes with the desired hardware characteristics.</li>
<li><strong>Configure Tolerations</strong>: Add tolerations to the workflow template to allow tasks to run on nodes with specific taints, enabling the reservation of nodes for specialised tasks.</li>
</ol>
<h5 id="benefits">Benefits</h5>
<p>The advantages of using hardware constraints in Argo Workflows include:</p>
<ul>
<li><strong>Optimised Resource Usage</strong>: Ensures that tasks are scheduled on nodes with sufficient and appropriate resources, preventing resource contention and optimising performance.</li>
<li><strong>Specialised Hardware Utilisation</strong>: Allows workflows to take advantage of nodes with specialised hardware, such as GPUs or high-memory nodes, by specifying appropriate constraints.</li>
<li><strong>Improved Workflow Efficiency</strong>: Enhances the efficiency of workflows by ensuring that tasks are executed on nodes that meet their resource and hardware requirements.</li>
</ul>
<h5 id="example-configuration">Example Configuration</h5>
<p>Below is a minimal example of a workflow configuration with hardware constraints:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Workflow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hardware-constraints-</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">  </span><span class="nt">templates</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">      </span><span class="nt">container</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;64Mi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;250m&quot;</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;128Mi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500m&quot;</span>
<span class="w">      </span><span class="nt">nodeSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">disktype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssd</span>
<span class="w">      </span><span class="nt">tolerations</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dedicated&quot;</span>
<span class="w">          </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Equal&quot;</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gpu&quot;</span>
<span class="w">          </span><span class="nt">effect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NoSchedule&quot;</span>
</code></pre></div>
<p>In this example:</p>
<ul>
<li>resources.requests: Specifies the minimum required CPU and memory for the task.</li>
<li>resources.limits: Specifies the maximum allowed CPU and memory for the task.</li>
<li>nodeSelector: Ensures the task is scheduled on a node with the label disktype: ssd.</li>
<li>tolerations: Allows the task to be scheduled on nodes with the taint dedicated=gpu:NoSchedule.</li>
</ul>
<h4 id="artefact-persistence-and-retention">Artefact Persistence and Retention</h4>
<blockquote>
<p>TBD section</p>
</blockquote>
<p>Argo Workflows provides mechanisms to manage the persistence of artefacts, ensuring that important data generated during workflow execution is retained and accessible for future use.</p>
<p>The features for managing artefact persistence in Argo Workflows include:</p>
<ul>
<li><strong>Persistent Artefacts</strong>: Mark specific artefacts for persistence, ensuring they are not discarded after workflow completion.</li>
<li><strong>Retention Policies</strong>: Define policies to manage the lifecycle of persistent artefacts, including archiving and expiration.</li>
</ul>
<p>The workflow engine operator must configure retention policies to remove expired workflows automatically
(see <a href="https://argo-workflows.readthedocs.io/en/stable/workflow-archive/">Archiving workflows</a>. </p>
<p>The workflow archive stores information about the workflows such as the status, pods executed, results and more. This information is stored in a database such as PostgreSQL.</p>
<p><strong>Archive TTL</strong>:
Specifies the time period to keep archived workflows before they will be deleted by the archived workflow garbage collection function. The default is forever.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="nt">persistence</span><span class="p">:</span>
<span class="w">  </span><span class="nt">archiveTTL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10d</span>
</code></pre></div></p>
<h4 id="logging">Logging</h4>
<p>Argo Workflows provides robust logging capabilities to help users monitor and debug their workflows. Logs are crucial for understanding the behaviour of workflows and diagnosing issues when they arise.</p>
<p>The logging features in Argo Workflows include:</p>
<ul>
<li><strong>Log Retrieval</strong>: Access logs for individual tasks directly through the Argo Workflows UI, CLI, or API.</li>
<li><strong>Log Storage</strong>: Configure log storage to persist logs for later analysis.</li>
<li><strong>Integration with Log Management Systems</strong>: Forward logs to external log management systems like Elasticsearch, Fluentd, or Kibana for advanced searching, indexing, and analysis.</li>
</ul>
<p>Argo Workflows captures logs from the containers running each workflow step. These logs can be accessed and managed as follows:</p>
<ol>
<li>
<p><strong>Log Retrieval via UI</strong>: Users can view the logs of each workflow step directly in the Argo Workflows web UI. This interface provides a convenient way to inspect logs without needing to access the underlying infrastructure.</p>
</li>
<li>
<p><strong>Log Retrieval via CLI</strong>: The <code>argo logs</code> command allows users to fetch and display logs for a specific workflow or task from the command line. This is useful for scripting and automated log retrieval.</p>
</li>
<li>
<p><strong>Log Retrieval via API</strong>: Logs can also be accessed programmatically through the Argo Workflows API, allowing integration with other systems and custom dashboards.</p>
</li>
<li>
<p><strong>Log Storage Configuration</strong>: Configure the storage of logs by specifying log archival options. This can be done using Kubernetes ConfigMaps or similar mechanisms to define where and how logs should be stored.</p>
</li>
<li>
<p><strong>Integration with Log Management Systems</strong>: For advanced log management, integrate Argo Workflows with external systems like Elasticsearch and Fluentd. These systems provide capabilities for indexing, searching, and visualising logs, enhancing the ability to monitor and troubleshoot workflows.</p>
</li>
</ol>
<h4 id="metrics">Metrics</h4>
<ul>
<li><strong>Monitoring</strong>: Argo produces metrics that provide information on the controller's status. As those metrics follow the same format as required by prometheus, those can be integrated with Prometheus.
  Two types of metrics are emitted by Argo:</li>
<li>Controller metrics: concerns the state of the controller;</li>
<li>Custom metrics: regards the state of a Workflow, or a series of Workflows. Those metrics can be defined on the Workflow/Step/Task emitting the metric. using the same name and help string, is a required by prometheus to track the metrics over time.</li>
</ul>
<p>For more information, see: See: https://argo-workflows.readthedocs.io/en/stable/metrics/</p>
<h3 id="subordinates">Subordinates</h3>
<p>Argo Workflows encompasses the various components and resources it manages and interacts with to orchestrate and execute workflows.</p>
<ul>
<li><strong>Workflow Templates</strong> : These are predefined configurations that describe specific workflows. They serve as blueprints from which instances of workflows are generated and executed. Workflow templates define the sequence of tasks, their dependencies, and the resources needed for each task.</li>
<li><strong>Tasks/Pods</strong> - In the context of Argo Workflow, each step in a workflow is executed as a separate pod within the Kubernetes environment. These pods can be considered subcomponents of the workflow they belong to, executing specific actions defined by the workflow and then reporting back their status upon completion or failure.</li>
</ul>
<blockquote>
<p>Note: identify the DB, message broker, prometheus, etc.</p>
</blockquote>
<h3 id="dependencies">Dependencies</h3>
<ul>
<li><strong>Description</strong>: Detail any operations or conditions that must be met before this component can function properly, including exclusions during its operation.</li>
</ul>
<blockquote>
<p>Note: if relevant, express dependency with other components (e.g. workflow needs module registry)
Reflect the config of charts </p>
</blockquote>
<h3 id="interfaces">Interfaces</h3>
<ul>
<li><strong>Control Flow</strong>: Describe how the component starts and terminates, including any interactions during execution (such as interrupts).</li>
<li><strong>Data Flow</strong>: Explain the input and output data flows, ensuring data structures are linked with control flows and interface components through common data areas or files.</li>
</ul>
<p>Documentation detailing the API specifications and usage is provided in teh <a href="./rest_api_design">API Design</a></p>
<blockquote>
<p>NOte: sequence diagram and link to the api-design document.</p>
</blockquote>
<h3 id="resources">Resources</h3>
<ul>
<li><strong>Requirements</strong>: Itemize what the component needs from its environment to perform its function, excluding items that are part of the component interface.</li>
</ul>
<blockquote>
<p>NOTE: include docker dependencies, might include maven dependencies (libs)</p>
</blockquote>
<h3 id="data">Data</h3>
<p>Argo Workflows utilises complex internal data structures to orchestrate and manage workflows within Kubernetes. The main structures include:</p>
<ul>
<li><strong>Workflow Definitions</strong>: Defined as custom resources in YAML, these include:</li>
<li><strong>Element Descriptions</strong>: Identifiers (names), types (e.g., script, container), and dimensions (step hierarchies and dependencies).</li>
<li><strong>Relationships</strong>: Defines parent-child relationships among steps using dependencies that structure the workflow as a Directed Acyclic Graph (DAG).</li>
<li><strong>Value Range</strong>: Includes everything from static strings to dynamic outputs from previous steps.</li>
<li>
<p><strong>Initial Values</strong>: Elements such as parameters may have default values specified in the workflow template.</p>
</li>
<li>
<p><strong>Workflow Status</strong>: This structure tracks the real-time state of each step within the workflow, indicating whether a step is pending, running, succeeded, or failed.</p>
</li>
<li>
<p><strong>Artifacts</strong>: Used to manage data inputs and outputs for each step. Artifacts can be files stored in various storage backends (e.g., S3, Artifactory).</p>
</li>
</ul>
<p>For more detailed information about the internal data structures used by Argo Workflows, including their specifications and how they are utilised within workflows, refer to the <a href="https://argo-workflows.readthedocs.io/en/stable/fields/">official Argo Workflows Field Reference</a>. This documentation provides comprehensive guides on defining and managing workflows, with specific sections on workflow specifications, status monitoring, and artifact handling.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
    
  </body>
</html>